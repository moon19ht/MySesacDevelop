# 🛢️ SQL 개념 설명서

##### 🗓️ 2025.05.21
##### 📝 Writer : Moon19ht

---

## 📚 목차

- [🔚 마무리](#-마무리)
- [⏭️ 다음으로는...](#️-다음으로는)
- [⏮️ 이전 문서](./0520%20Python정리.md) [다음 문서 ⏭️](./0526%20SQL정리.md)

---


## 🔗 JOIN & 서브쿼리

### ✅ INNER JOIN
```sql
SELECT e.name, d.dept_name
FROM employees e
INNER JOIN departments d ON e.dept_id = d.dept_id;
```

### ✅ LEFT JOIN
```sql
SELECT e.name, d.dept_name
FROM employees e
LEFT JOIN departments d ON e.dept_id = d.dept_id;
```

### ✅ 서브쿼리 (SubQuery)
```sql
SELECT name
FROM employees
WHERE dept_id = (SELECT dept_id FROM departments WHERE dept_name = 'Sales');
```

### ✅ 상관 서브쿼리
```sql
SELECT name
FROM employees e
WHERE salary > (
    SELECT AVG(salary)
    FROM employees
    WHERE dept_id = e.dept_id
);
```

---

## 🔀 CASE문

조건에 따라 다른 값을 출력할 때 사용

```sql
SELECT name,
  CASE
    WHEN salary >= 7000 THEN '고소득'
    WHEN salary >= 4000 THEN '중간소득'
    ELSE '저소득'
  END AS 소득등급
FROM employees;
```

---

## 🏗️ CREATE & INSERT & DROP

### 🛠️ 명령어를 통한 테이블 생성

```sql
CREATE TABLE departments (
  dept_id INT PRIMARY KEY,
  dept_name VARCHAR(50)
);

CREATE TABLE employees (
  emp_id INT PRIMARY KEY,
  name VARCHAR(50),
  salary DECIMAL(10,2),
  dept_id INT,
  FOREIGN KEY (dept_id) REFERENCES departments(dept_id)
);
```

### ➕ INSERT 명령어 사용

```sql
INSERT INTO departments (dept_id, dept_name) VALUES (101, '개발');
INSERT INTO employees (emp_id, name, salary, dept_id) VALUES (1, '홍길동', 5000, 101);
```

### 🗑️ DROP 명령어

```sql
DROP TABLE employees;
DROP TABLE departments;
```

---

## 🖥️ GUI를 통한 테이블 생성 (Workbench, DBeaver 등)

1. GUI 도구 실행 → 연결된 데이터베이스 선택
2. 새 테이블 생성 클릭
3. 컬럼 추가 (타입, Primary Key 설정 등)
4. 저장 (SQL 명령 자동 생성됨)

---

## 🔗 FOREIGN KEY 직접 생성 및 테스트

### 테이블 생성
```sql
CREATE TABLE categories (
  category_id INT PRIMARY KEY,
  category_name VARCHAR(50)
);

CREATE TABLE products (
  product_id INT PRIMARY KEY,
  product_name VARCHAR(50),
  category_id INT,
  FOREIGN KEY (category_id) REFERENCES categories(category_id)
);
```

### 데이터 삽입
```sql
INSERT INTO categories VALUES (1, '전자기기');
INSERT INTO products VALUES (100, '노트북', 1);
```

### 외래 키 제약 위반 예시 (존재하지 않는 키 삽입 시도)
```sql
INSERT INTO products VALUES (101, '스마트폰', 99); -- 실패
```

### 삭제 제한 테스트
```sql
DELETE FROM categories WHERE category_id = 1; -- 관련 products가 있으면 실패
```

---

## ✅ 요약

| 항목 | 설명 |
|------|------|
| JOIN | 여러 테이블을 연결해 조건에 맞는 행을 조회 |
| SubQuery | 메인 쿼리 내에 포함된 쿼리로, 조건 설정에 활용 |
| CASE문 | 조건에 따른 분기 처리 가능 |
| CREATE | 테이블/데이터베이스 생성 |
| INSERT | 데이터 삽입 |
| DROP | 테이블 삭제 |
| GUI 도구 | Workbench, DBeaver 등으로 직관적인 테이블 설계 가능 |
| FOREIGN KEY | 테이블 간 관계 설정 및 무결성 보장 |

